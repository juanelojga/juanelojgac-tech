############################################
# GLOBAL: Disable builds by default
############################################

[build]
command = "echo 'Skipping Netlify build for non-production environments'"
publish = "dist"
ignore = "exit 0" # always skip unless overridden

############################################
# PRODUCTION: Actual build & deploy
############################################

[context.production]
[context.production.build]
command = "npm run build"
publish = "dist"

############################################
# HEADERS: Caching for static assets
############################################

[[headers]]
for = "/assets/*"
[headers.values]
Cache-Control = "public, max-age=31536000, immutable"

[[headers]]
for = "/*.js"
[headers.values]
Cache-Control = "public, max-age=31536000, immutable"

[[headers]]
for = "/*.css"
[headers.values]
Cache-Control = "public, max-age=31536000, immutable"

############################################
# HTML: Cache lightly (avoid stale pages)
############################################

[[headers]]
for = "/*.html"
[headers.values]
Cache-Control = "public, max-age=600"


############################################
# ENVIRONMENT: Only for production
############################################

[context.production.environment]
HUSKY = "0"
NODE_VERSION = "24"
NODE_ENV = "production"
ASTRO_TELEMETRY_DISABLED = "1"

############################################
# DISABLE PROCESSING (performance)
############################################

[build.processing]
skip_processing = true
